#!/bin/bash

# Function to print header with color
print_header() {
    printf "\e[1;36m%-10s %-10s %-10s %-10s\e[0m\n" "PID" "CPU%" "MEM%" "COMMAND"
}

# Function to print process info with color
print_process_info() {
    pid=$1
    cpu_percent=$2
    mem_percent=$3
    cmd=$4
    printf "%-10s %-10.2f %-10.2f %-10s\n" "$pid" "$cpu_percent" "$mem_percent" "$cmd"
}

# Function to display help
display_help() {
    echo "Usage: ./mytop.sh"
    echo "  h - Display help"
    echo "  q - Quit"
}

# Main function
main() {
    clear
    print_header
    while true; do
        processes=$(ps ax -o pid,%cpu,%mem,cmd --sort=-%cpu | head -n 11 | awk 'NR>1')
        while IFS= read -r line; do
            pid=$(echo "$line" | awk '{print $1}')
            cpu_percent=$(echo "$line" | awk '{print $2}')
            mem_percent=$(echo "$line" | awk '{print $3}')
            cmd=$(echo "$line" | awk '{$1="";$2="";$3=""; print $0}')
            print_process_info "$pid" "$cpu_percent" "$mem_percent" "$cmd"
        done <<< "$processes"
        read -t 1 -n 1 input
        clear
        print_header
        case $input in
            h)  display_help ;;
            q)  break ;;
            *)  ;;
        esac
    done
}

# Run main function
main
